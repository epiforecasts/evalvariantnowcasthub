---
title: "Supplement: Collaborative estimation and evaluation of SARS-CoV-2 variant nowcasting in the U.S."
authors: "To be updated"
format: docx
editor: visual
date: 2025-11-11
bibliography: ref.bib
csl: vancouver.csl
output:
  bookdown::docx:
    fig_caption: yes
---

# Additional models not evaluated in this work

The following models began submissions following the initial assessment period (October 9th, 2024 to June 4th, 2025).

| Model name | Description | Citation | Data Sources | Locations | Output Type | Ensemble? |
|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
| `open_hier_mlr` | A Bayesian hierarchical multinomial logistic regression (MLR) model for nowcasting COVID variants using variant counts based on INSDC sequences. Regression coefficients are modeled hierarchically across locations. | Abousamra E, Figgins M, Bedford T (2024) Fitness models provide accurate short-term forecasts of SARS-CoV-2 variant frequency. PLOS Computational Biology 20(9): e1012443. https://doi.org/10.1371/journal.pcbi.1012443 | International Nucleotide Sequence Database Collaboration (INSDC) | All | Point and probabilistic | No |
| `gisaid_hier_mlr` | A Bayesian hierarchical multinomial logistic regression (MLR) model for nowcasting COVID variants using variant counts based on GISAID sequences. Regression coefficients are modeled hierarchically across locations. | Abousamra E, Figgins M, Bedford T (2024) Fitness models provide accurate short-term forecasts of SARS-CoV-2 variant frequency. PLOS Computational Biology 20(9): e1012443. https://doi.org/10.1371/journal.pcbi.1012443 | Global Initiative on Sharing All Influenza Data (GISAID) | All | Point and probabilistic | No |
| `ensemble` | An ensemble of the hub forecasts, created by taking an equally weighted sample of all forecasts that submit samples for a given week, using the function linear_pool from the hubEnsembles package. | https://github.com/hubverse-org/hubEnsembles/tree/main | Other model submission files | All | Point and probabilistic | No |
| `PyHMLR` | A Bayesian hierarchical multinomial logistic regression model with Dirichlet-Multinomial observation process. The model uses hierarchical hyperpriors to enable partial pooling across locations and clades. Location-specific concentration parameters allow the model to adaptively learn appropriate uncertainty levels for each location. Linear trends are modeled in logit space with standardized time variables. | https://github.com/trobacker/pymc_modeling | COVID Variant Nowcast Hub S3 target data | All | Point and probabilistic | No |

# Additional figures

## Data landscape

![Fig. S1 Distribution of sequence counts compared to population size in the United States. A. Total number of sequences collected and submitted by the final evaluation date for each state during the period from September 2024 to June 2025. Color indicates whether the location's sequences are among the top 90th percentile of all sequences submitted nationally B. Population size for each jurisdiction, ordered by total number of sequences submitted. Color indicates whether the population size is among the top 90th percentile of the total population.](../output/figs/data_figs/supp/bar_chart_all_seq_counts_final.png)

![Fig. S2 Example final sequence data from CA](../output/figs/data_figs/supp/final_seq_data_ex1.png)

![Fig. S3 Example final sequence data from IL](../output/figs/data_figs/supp/final_seq_data_ex2.png)

![Fig. S4 Example final sequence data from MN](../output/figs/data_figs/supp/final_seq_data_ex3.png)

![Fig. S5 Different dynamics of 25A emergence](../output/figs/eda/plot_25A_emergence.png)

## Model nowcasts

![Fig. S6 Model nowcasts for the CADPH-CATaLog model from February 19th, 2025. Colors indicate clade, dashed vertical line indicates the nowcast date.](../output/figs/nowcasts/supp/fig_model_nowcasts_CADPH.png)

## Submission metadata

![Fig. S7 Model submission coverage by location and nowcast date for each participating model. Tiles colored by model-specific colors indicate dates and locations where the model submitted a forecast. Gray tiles indicate missing submissions. Locations are ordered by the total number of final evaluation sequences (lowest at the top, highest at the bottom).](../output/figs/metadata/supp/submission_heatmaps_by_model.png)

![Fig. S8 Summary of model submission coverage across all models. Color indicates the number of models that submitted forecasts for each location and nowcast date combination, ranging from 0 (no models) to 6 (all models). Locations are ordered by the total number of final evaluation sequences (lowest at the top, highest at the bottom).](../output/figs/metadata/supp/submission_heatmaps_summary.png)

![Fig. S9 Evaluation sequence counts by location and nowcast date. Color indicates the total number of sequences available in the evaluation data (log scale) for each location and nowcast date combination. Gray tiles indicate nowcast date-location pairs with no sequences across all horizons. Locations are ordered by the total number of final evaluation sequences (lowest at the top, highest at the bottom).](../output/figs/metadata/supp/eval_sequence_counts_heatmap.png)

![Fig. S10 Analysis of historical lags from collection to submission. Each line represents a week of data and the y-axis is the ratio of how much data we have at the given data lag compared to 19 weeks after that week , treating 19 weeks as the maximum delay (and thus data at 19 weeks has a ratio of 1). The dashed blue line represents when we perform evaluations (a 90 day, or 14 week, lag)](../output/figs/supp/data_lags_by_week.jpeg)

![Fig. S11 Proportion of evaluated days that contained no partial observations as of the nowcast date by nowcast horizon, summarised across all locations and nowcast dates. Days which had partial observations as of the nowcast date are excluded from the main text evaluation analyses, consistent with our stated evaluation plan and in order to prevent incentivising modelers from predicting the already observed clade frequency.](../output/figs/supp/prop_no_partial_obs_overall.png)

![Fig. S12 Proportion of evaluated days that contain partial observations as of the nowcast date by nowcast horizon for each location across all nowcast dates. Days which had partial observations as of the nowcast date are excluded from the main text evaluation analyses.](../output/figs/supp/prop_no_partial_obs_loc.png)

## Additional results

![Fig. S13 Comparison of relative scaled skill computed using the overlapping set of horizons (circles), nowcast dates and locations versus the average of relative scaled skill scores on the Brier score in the US excluding California (triangles). The average of relative scales skill is computed for each horizon, location, and nowcast date and then averaged across the relative scaled skill scores, which has the effect of weighting each horizon, location, and nowcast date equally rather than weighting by the number of observed sequences. Color indicates model.](../output/figs/supp/avg_rel_skill_brier.png)

![Fig. S14 Comparison of relative scaled skill computed using the overlapping set of horizons (circles), nowcast dates and locations versus the average of relative scaled skill scores on the energy score in the US excluding California (triangles). The average of relative scales skill is computed for each horizon, location, and nowcast date and then averaged across the relative scaled skill scores, which has the effect of weighting each horizon, location, and nowcast date equally rather than weighting by the number of observed sequences. Color indicates model.](../output/figs/supp/avg_rel_skill_energy.png)

![Fig. S15 Heatmap of scaled relative skill scores on the energy score across nowcast dates and locations for each model. Higher scaled relative skill (red) indicates degraded performance compared to the baseline, lower scaled relative skill indicates improved performance.](../output/figs/supp/heatmap_rel_skill_energy.png)

![Fig. S16 Histogram of the distribution of scaled relative skill scores on the energy score across nowcast dates and locations for each model.](../output/figs/supp/distrib_rel_skill_energy.png)

![Fig. S17 Heatmap of scaled relative skill scores on the Brier score across nowcast dates and locations for each model.](../output/figs/supp/heatmap_rel_skill_brier.png)

![Fig. S18 Histogram of the distribution of scaled relative skill scores on the Brier score across nowcast dates and locations for each model.](../output/figs/supp/distrib_rel_skill_brier.png)

![Fig. S19 Comparison of relative scaled skill computed using the overlapping set of horizons (circles), nowcast dates and locations versus the average of relative scaled skill scores on the Brier score in California (triangles). The average of relative scales skill is computed for each horizon, location, and nowcast date and then averaged across the relative scaled skill scores, which has the effect of weighting each horizon, location, and nowcast date equally rather than weighting by the number of observed sequences. Color indicates model.](../output/figs/supp/avg_rel_skill_brier_ca.png)

![Fig. S20 Comparison of relative scaled skill computed using the overlapping set of horizons (circles), nowcast dates and locations versus the average of relative scaled skill scores on the energy score in California (triangles). The average of relative scales skill is computed for each horizon, location, and nowcast date and then averaged across the relative scaled skill scores, which has the effect of weighting each horizon, location, and nowcast date equally rather than weighting by the number of observed sequences. Color indicates model.](../output/figs/supp/avg_rel_skill_energy_ca.png)

![Fig. S21 Comparison of the observed clade proportions by sequence collection week across nowcast dates (columns) in the California COVIDNet data (top row) and the GenBank data provided by the Hub and used by most other models (bottom row). Colors indicate clade, dashed line indicates the nowcast date. In most weeks, the California COVIDNet data has observed clade proportions for a more recent week than the GenBank dataset does for California.](../output/figs/supp/CA_source_seq_props.png)

![Fig. S22 Ratio of the number of sequences available in the GenBank dataset for California compared to California COVIDNet across collection dates for a subset of nowcast dates (columns). Patterns indicate that even further back in time, the GenBank dataset at most makes up between 50% and 90% of the California COVIDNet data volume, with a particular drop off closer to the nowcast date.](../output/figs/supp/CA_source_seq_level_comparison.png)

![Fig. S23 Absolute Brier (top) and energy (bottom) in the U.S. excluding California (left) and California (right) by horizon.](../output/figs/overall_scores/supp/absolute_scores_by_horizon.png)

![Fig. S24 Score comparison over all nowcast dates, horizons, and jurisdictions, including days when sequences had already been reported during the nowcast horizons. Color indicates model. Energy and Brier scores for each model are averaged across all of the nowcast dates, horizons, and jurisdictions for which the model submitted, stratified by the US excluding California on the left and California only on the right. Relative scaled skill scores are computed using only the set of overlapping nowcast dates, horizons, and jurisdictions for each pairwise model comparison, and are summarised for each model by taking the geometric mean across all score ratios containing that model, ensuring that a fair comparison is made when nowcast sets differ. (A & C). Absolute Brier score overall. Brier scores are computed using the mean nowcast. (B & D). Relative scaled skill on the Brier score overall. RSS $<$ 1 indicates improved performance over the Hub-baseline, RSS $>$ 1 indicates poorer performance. (E & G). Absolute energy score overall. (F & H). Relative scaled skill on the energy score overall. (I & J). Relative scaled skill on the Brier score by nowcast horizon, with vertical dashed line indicating horizon 0 (the nowcast date). (K & L). Relative scaled skill on the energy score by nowcast horizon. Scores are summarised across the U.S. excluding California (left) and California on its own (right), across nowcast dates. Models submitting only means are evaluated using only the Brier score on the point estimate of the mean, models submitting trajectories are evaluated using the energy score. Results are stratified by the U.S. excluding California and California because CADPH-CATaLog and CADPH-CATaMaran only submitted for California and thus the set of model submissions differed across these jurisdictional boundaries.](../output/figs/overall_scores/overall_score_comparison_ne.png)

![Fig. S25 Score comparison of the absolute and relative Brier and energy scores across nowcast dates and horizons for each location, including days when sequences had already been reported during the nowcast horizons. Jurisdictions are shown in descending order by the total number of sequences during the evaluation period (September 2024 through June 2025). Absolute Brier score averaged across nowcast dates and horizons for each jurisdiction. Brier scores are computed using the mean nowcast. B. Relative scaled skill on the Brier score versus the Hub-baseline. RSS $<$ 1 indicates improved performance over the Hub-baseline, RSS $>$ 1 indicates reduced performance. C. Absolute energy score averaged across nowcast dates and target dates for each jurisdiction. Energy scores are computed using the full predictive distribution submitted. D. Relative scaled skill on the Energy score versus the Hub-baseline. E. Total number of sequences collected and submitted by the time of the final evaluation dataset for each jurisdiction, ordered by the total number. Y-axis is in log scale. Color indicates model.](../output/figs/overall_scores/by_location_ne.png)

![Fig. S26 Score comparison by nowcast date stratified by the US excluding California (left) and California (right). (A & B). Absolute Brier score at each nowcast date. (C & D). Relative scaled skill on the Brier score at each nowcast date. RSS $<$ 1 indicates improved performance over the Hub-baseline, RSS $>$ 1 indicates reduced performance. (E & F). Absolute energy score at each nowcast date. (G & H). Relative scaled skill on the energy score at each nowcast date. (I & J). Number of sequences available within the nowcast period. (K & L). Number of sequences for evaluation by nowcast date.](../output/figs/overall_scores/by_nowcast_date_ne.png)

![Fig. S27 Bias over time for three example states in the US during the 25A emergence.](../output/figs/zoom_25A/supp/bias_over_time_25A.png)
